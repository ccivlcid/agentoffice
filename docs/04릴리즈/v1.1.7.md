# HyperClaw v1.1.7 Release Notes

- Release date: 2026-02-23
- Scope: OpenCode stream-output hardening for Kimi-based runs (chat + task execution), explicit user-facing error handling for common failure paths, plus two post-v1.1.6 hotfixes (custom API version-path compatibility and setup frontend-port correction).

## Highlights

- **OpenCode/Kimi Final-Reply Stability**
  - Stream parsing now prioritizes user-facing final text and suppresses internal/noise events (`thinking`, `reasoning`, `tool_use`, `tool_result`, `step_finish`).
  - Prevents raw stream JSON/tool payload fragments from leaking into final chat/task output.

- **Terminal Pretty Log: Reasoning Visibility Restored**
  - `/api/tasks/:id/terminal?pretty=1` now includes OpenCode `thinking`/`reasoning` traces again for operator debugging.
  - Final user-facing reply paths still keep internal reasoning hidden.

- **Explicit Failure Replies (No Silent Fallback for Known Cases)**
  - Added explicit direct-reply error handling for:
    - file-access permission block (`external_directory`, auto-reject)
    - stale file write conflict (`File ... has been modified since it was last read`)
    - `step_finish` ending with `reason="tool-calls"` and no final assistant reply
    - timeout and other generic CLI failures
  - Improves operator visibility by returning clear, user-readable failure reasons instead of generic fallback text.

- **OpenCode Progress-Hint Reliability**
  - Terminal progress-hint parsing now supports `callID` / `callId` / `call_id` variants.
  - Tracks repeated `tool_use` status transitions (`completed`/`error`) so result hints are not dropped when the same call id reappears.

- **Hotfix 1: Custom API Provider Non-`v1` Version Paths**
  - OpenAI-compatible custom providers now preserve `/vN` base paths (for example `/v4`) instead of forcing `/v1`.
  - Fixes malformed double-path requests such as `/v4/v1/chat/completions` that caused 404 errors.

- **Hotfix 2: Setup Frontend Port Output Correction**
  - `scripts/openclaw-setup.sh` and `scripts/openclaw-setup.ps1` now print the correct frontend URL:
    - `http://127.0.0.1:8800`
  - Resolves onboarding confusion from the previous `5173` output.

## Changed Files

### Backend
- `server/modules/routes/ops.ts`
- `server/modules/workflow/core.ts`
- `server/modules/workflow/agents/providers.ts`

### Setup Scripts
- `scripts/openclaw-setup.sh`
- `scripts/openclaw-setup.ps1`

### Docs
- `README.md`
- `README_ko.md`
- `README_jp.md`
- `README_zh.md`
- `docs/releases/README.md`
- `docs/releases/v1.1.7.md`

## Verification

- `pnpm run test:api`
  - api tests passed
- `pnpm run build`
  - `vite build` passed
