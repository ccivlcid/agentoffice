# HyperClaw v1.0.6 Release Notes

- Release date: 2026-02-20
- Scope: Windows cross-platform compatibility fixes, OAuth model provider independence, CLI tool detection hardening, and skill-install process fix.

## Highlights

- **OAuth model list now fetches directly from provider API** instead of depending on `opencode` CLI:
  - GitHub Copilot models are retrieved via the Copilot API token exchange flow (`exchangeCopilotToken` → `/models` endpoint)
  - 3-tier model resolution: provider API first → opencode supplement → static fallback list
  - Eliminates hard dependency on opencode for OAuth-based model discovery
- **Windows CLI tool detection fixed** (`ENOENT` / exit code `-4058`):
  - `execFile` on Windows cannot execute `.cmd` wrapper files directly
  - Added `shell: true` to `execWithTimeout` when `process.platform === "win32"`
  - Affects all CLI tools: Claude Code, Codex CLI, Gemini CLI, OpenCode
- **Gemini CLI version detection** no longer hangs:
  - `gemini --version` and `gemini -v` both start an interactive session instead of printing version
  - Added custom `getVersion()` that reads version from `node_modules/@google/gemini-cli/package.json`
- **Settings panel version display** improved:
  - Shows "Version unknown" instead of "Not installed" when a CLI tool is detected but version cannot be determined
  - Prevents misleading "not installed" status for tools that are actually present
- **Windows skill learning fixed** (`spawn npx ENOENT`):
  - Background `npx skills add ...` job now uses `shell: true` on Windows
  - Same root cause as CLI detection: `.cmd` wrappers require shell execution on Windows
- **Non-interactive esbuild build approval**:
  - Added `pnpm.onlyBuiltDependencies: ["esbuild"]` to `package.json` so `pnpm install` works in non-interactive environments (CI, AI agents)

## Problem-Cause Alignment

This patch addresses three platform-specific failures observed during Windows environment setup:

1. **`spawn npx ENOENT`** — Node.js `spawn`/`execFile` cannot find `.cmd` files without `shell: true` on Windows. Affects CLI detection and skill install jobs.
2. **`gemini --version` hangs** — Gemini CLI does not support `--version`/`-v` flags; they start an interactive REPL instead.
3. **OAuth model list empty** — Model override panel showed no models because it depended entirely on `opencode models` CLI command, which may not be installed.

## Changed Files

- `server/modules/workflow/agents/providers.ts` — `execWithTimeout` shell fix, `getVersion()` for Gemini, `exchangeCopilotToken` export
- `server/modules/workflow/agents.ts` — Context chain propagation for `exchangeCopilotToken`
- `server/modules/routes/ops.ts` — `fetchCopilotModelsFromAPI()`, 3-tier model resolution, skill-learn `spawn` shell fix
- `src/components/SettingsPanel.tsx` — Version display fallback ("Version unknown")
- `package.json` — Version bump, `pnpm.onlyBuiltDependencies`
- `.gitignore` — Added `docs/.bkit-*` and `docs/.pdca-*` patterns

## Maintenance Notes

- All Windows fixes use conditional `shell: true` (only when `process.platform === "win32"`) to avoid unnecessary shell overhead on macOS/Linux.
- The `exchangeCopilotToken` function follows the existing context injection chain: `providers.ts` → `agents.ts` → `ops.ts` via `__ctx`.
- Copilot API model list uses the same token exchange mechanism already used for agent task execution.
