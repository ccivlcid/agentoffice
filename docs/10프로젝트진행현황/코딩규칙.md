# HAIFeR Agent 코딩 규칙 & 컨벤션

---

## 1. 파일 규칙

| 규칙 | 설명 |
|------|------|
| **단일 파일 300줄 이하** | 초과 시 모듈/컴포넌트/훅으로 분리 |
| **DRY, 단일 책임** | 중복 제거, 하나의 파일은 하나의 책임 |
| **주석은 이유 위주** | "무엇"이 아닌 "왜"를 설명 |
| **검증**: `pnpm check:lines` | 300줄 제한 자동 검증 |

---

## 2. 네이밍 컨벤션

| 대상 | 규칙 | 예시 |
|------|------|------|
| 프론트 컴포넌트/페이지 | PascalCase | `TaskBoard.tsx`, `ChatPanel.tsx` |
| 유틸/훅 | camelCase | `useWebSocket.ts`, `appHelpers.ts` |
| 백엔드 파일명 | kebab-case | `tasks-run.ts`, `agents-cli.ts` |
| 클래스 | PascalCase | `IdempotencyConflictError` |
| 함수 | camelCase | `handleTaskRunComplete()` |
| 상수 | UPPER_SNAKE_CASE | `REVIEW_MAX_ROUNDS` |

---

## 3. Git 컨벤션

### 커밋
- **Conventional Commits** 형식
- 예: `feat: add project manager modal`, `fix: orphan task sweep`

### 브랜치 전략
| 브랜치 | 역할 |
|--------|------|
| `main` | 안정 릴리즈 |
| `dev` | 통합 개발 |
| `feature/*` | 기능 개발 |
| `fix/*` | 버그 수정 |

### PR 규칙
- 1명 이상 승인 필수
- CI 통과 필수
- **Squash & Merge** (깔끔한 이력)

---

## 4. Git 안전 규칙

| 규칙 | 설명 |
|------|------|
| 자동 커밋 금지 | 에이전트가 스테이지/준비는 가능, 사용자 승인 필수 |
| 커밋 전 테스트 | 테스트 통과 → 승인 → 커밋 |
| 새 커밋 생성 | 훅 실패 시 amend가 아닌 새 커밋 |
| Force push 금지 | main/dev에 force push 절대 금지 |

---

## 5. 코드 품질

| 항목 | 도구/규칙 |
|------|-----------|
| TypeScript Strict | `tsconfig.app.json` strict: true |
| 타겟 | ES2022 |
| 모듈 | ESNext |
| 300줄 검증 | `pnpm check:lines` |
| 아키텍처 맵 | `pnpm arch:map` |
| 보안 스캔 | `pnpm preflight:public` (릴리즈 전) |

---

## 6. 언어 규칙 (AGENTS.md)

- **항상 사용자 언어에 맞춤**: 한국어→한국어, 영어→영어
- CEO 디렉티브 (`$` 접두사) 감지 시:
  1. 언어 감지
  2. 프로젝트 확인 (기존/신규)
  3. 팀 회의 여부 확인
  4. `/api/inbox`에 전송 (`x-inbox-secret` 헤더)
